{"version":3,"file":"pkce.js","sourceRoot":"","sources":["../../src/utils/pkce.ts"],"names":[],"mappings":"AAAA,MAAM,UAAU,SAAS,CAAC,GAAsC;IAC9D,MAAM,GAAG,GACP,OAAO,GAAG,KAAK,QAAQ;QACrB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;QACX,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,YAAY,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;IAC3F,OAAO,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAA;AACxE,CAAC;AAED,MAAM,UAAU,oBAAoB,CAAC,CAAC,GAAG,EAAE;IACzC,MAAM,CAAC,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,CAAA;IAC3B,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,CAAA;IACzB,OAAO,SAAS,CAAC,CAAC,CAAC,CAAA;AACrB,CAAC;AAED,KAAK,UAAU,MAAM,CAAC,KAAa;IACjC,MAAM,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;IAC3C,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,CAAC,CAAA;IACzD,OAAO,IAAI,UAAU,CAAC,MAAM,CAAC,CAAA;AAC/B,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,YAAY;IAChC,MAAM,QAAQ,GAAG,oBAAoB,CAAC,EAAE,CAAC,CAAA;IACzC,MAAM,SAAS,GAAG,SAAS,CAAC,MAAM,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAA;IACnD,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,EAAE,MAAe,EAAE,CAAA;AACzD,CAAC;AAED,MAAM,UAAU,mBAAmB,CAAc,CAAS;IACxD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC,CAAA;AAClE,CAAC","sourcesContent":["export function base64url(buf: ArrayBuffer | Uint8Array | string) {\n  const bin =\n    typeof buf === 'string'\n      ? btoa(buf)\n      : btoa(String.fromCharCode(...(buf instanceof Uint8Array ? buf : new Uint8Array(buf))))\n  return bin.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/g, '')\n}\n\nexport function randomBytesBase64Url(n = 32) {\n  const a = new Uint8Array(n)\n  crypto.getRandomValues(a)\n  return base64url(a)\n}\n\nasync function sha256(input: string) {\n  const enc = new TextEncoder().encode(input)\n  const digest = await crypto.subtle.digest('SHA-256', enc)\n  return new Uint8Array(digest)\n}\n\nexport async function makePkcePair() {\n  const verifier = randomBytesBase64Url(64)\n  const challenge = base64url(await sha256(verifier))\n  return { verifier, challenge, method: 'S256' as const }\n}\n\nexport function fromBase64UrlToJSON<T = unknown>(s: string): T {\n  return JSON.parse(atob(s.replace(/-/g, '+').replace(/_/g, '/')))\n}\n"]}